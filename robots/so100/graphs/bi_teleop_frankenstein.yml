nodes:
  - id: lcr-left-leader
    build: pip install ../../../node-hub/dynamixel-client
    path: dynamixel-client
    inputs:
      pull_position:
        source: dora/timer/millis/10 # pull the position every 10ms
        queue_size: 1

      write_goal_position:
        source: lcr-to-lcr-left/leader_goal
        queue_size: 1

    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem575E0030111
      CONFIG: ../../alexk-lcr/configs/leader.startup

  - id: lcr-to-lcr-left
    path: ../../alexk-lcr/nodes/interpolate_lcr_to_lcr.py
    inputs:
      leader_position:
        source: lcr-left-leader/position
        queue_size: 1

      follower_position:
        source: lcr-left-follower/position
        queue_size: 1
    outputs:
      - follower_goal
      - leader_goal
    env:
      LEADER_CONTROL: ../../alexk-lcr/configs/leader.left.control
      FOLLOWER_CONTROL: ../../alexk-lcr/configs/follower.left.control

  - id: lcr-left-follower
    build: pip install ../../../node-hub/dynamixel-client
    path: dynamixel-client
    inputs:
      pull_position:
        source: dora/timer/millis/10
        queue_size: 1

      write_goal_position:
        source: lcr-to-lcr-left/follower_goal
        queue_size: 1
    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem575E0031141
      CONFIG: ../../alexk-lcr/configs/follower.startup

  - id: lcr-right-leader
    build: pip install ../../../node-hub/dynamixel-client
    path: dynamixel-client
    inputs:
      pull_position:
        source: dora/timer/millis/10
        queue_size: 1

      write_goal_position: lcr-to-so100/leader_goal

    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem575E0030531
      CONFIG: ../../alexk-lcr/configs/leader.startup

  - id: lcr-to-so100
    path: ../nodes/interpolate_lcr_to_so100.py
    inputs:
      leader_position:
        source: lcr-right-leader/position
        queue_size: 1

      follower_position:
        source: so100-follower/position
        queue_size: 1

    outputs:
      - follower_goal
      - leader_goal

    env:
      LEADER_CONTROL: ../../alexk-lcr/configs/leader.right.control
      FOLLOWER_CONTROL: ../configs/follower.left.control

  - id: so100-follower
    build: pip install ../../../node-hub/feetech-client
    path: feetech-client
    inputs:
      pull_position:
        source: dora/timer/millis/10
        queue_size: 1

      write_goal_position:
        source: lcr-to-so100/follower_goal
        queue_size: 1

    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem585A0077581
      CONFIG: ../configs/follower.startup