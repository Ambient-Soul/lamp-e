nodes:
  - id: lcr-leader
    build: pip install ../../../node_hub/dynamixel-client
    path: dynamixel-client
    inputs:
      pull_position: lcr-follower-simu/tick
    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem575E0030111

      IDS: 1 2 3 4 5 6
      JOINTS: shoulder_pan shoulder_lift elbow_flex wrist_flex wrist_roll gripper
      MODELS: x_series x_series x_series x_series x_series x_series

      TORQUE: False False False False False True

      INITIAL_GOAL_POSITION: None None None None None -450
      INITIAL_GOAL_CURRENT: None None None None None 40

      OFFSETS: -2048 -3072 1024 -2048 1024 2048
      DRIVE_MODES: POS POS NEG POS NEG NEG

  - id: lcr-interpolate
    path: ../nodes/interpolate_lcr_to_lcr.py
    inputs:
      leader_position: lcr-leader/position
      follower_position: lcr-follower/position
    outputs:
      - goal_position

  - id: lcr-follower
    build: pip install ../../../node_hub/dynamixel-client
    path: dynamixel-client
    inputs:
      pull_position: dora/timer/millis/10
      write_goal_position: lcr-interpolate/goal_position

      end: lcr-follower-simu/end
    outputs:
      - position
    env:
      PORT: /dev/tty.usbmodem575E0031141

      IDS: 1 2 3 4 5 6
      JOINTS: shoulder_pan shoulder_lift elbow_flex wrist_flex wrist_roll gripper
      MODELS: x_series x_series x_series x_series x_series x_series

      TORQUE: True True True True True True

      INITIAL_GOAL_POSITION: None None None None None None
      INITIAL_GOAL_CURRENT: None None None None None 500

      OFFSETS: -2048 2048 2048 2048 1024 2048
      DRIVE_MODES: POS NEG NEG NEG NEG NEG

  - id: lcr-interpolate-simu
    path: ../nodes/interpolate_lcr_to_simu_lcr.py
    inputs:
      leader_position: lcr-leader/position
    outputs:
      - goal_position

  - id: lcr-follower-simu
    build: pip install ../../../node_hub/mujoco-client
    # for windows
    # path: mujoco-client
    # for macos
    path: mjpython
    args: ../../../node_hub/mujoco-client/main.py
    inputs:
      pull_position: dora/timer/millis/10
      write_goal_position: lcr-interpolate-simu/goal_position

      tick: dora/timer/millis/10
    outputs:
      - position
      - tick
      - end

    env:
      SCENE: ../assets/simulation/reach_cube.xml

      JOINTS: shoulder_pan_joint shoulder_lift_joint elbow_flex_joint wrist_flex_joint wrist_roll_joint gripper_joint

      INITIAL_GOAL_POSITION: None None None None None None